!function(){var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function t(e,r){n(this,t),this.vector=e,this.value=r},a=function(){function t(e,r){n(this,t),this.x=e,this.y=r}return r(t,[{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y)}}]),t}(),c=function(){function t(e){n(this,t),this._cells=e.map((function(t,e){return t.map((function(t,r){return new o(new a(r,e),t)}))}))}return r(t,[{key:"at",value:function(t){return this._cells[t.y][t.x]}},{key:"cells",get:function(){return this._cells.flat()}}]),t}();function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=v(t);if(e){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function l(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e,r){return e&&y(t.prototype,e),r&&y(t,r),t}var b,d,j=function(){function t(){p(this,t),this.postures=this.getRawPostures().map((function(t){return new c(t)})),this.postureIndex=0}return h(t,[{key:"rotate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.postureIndex=(this.postureIndex+t+this.postures.length)%this.postures.length}},{key:"posture",get:function(){return this.postures[this.postureIndex]}}]),t}(),_=function(t){u(r,t);var e=s(r);function r(){return p(this,r),e.apply(this,arguments)}return h(r,[{key:"getRawPostures",value:function(){return[[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]],[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]]]}}]),r}(j),w=function(t){u(r,t);var e=s(r);function r(){return p(this,r),e.apply(this,arguments)}return h(r,[{key:"getRawPostures",value:function(){return[[[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0]]]}}]),r}(j),g={},O={},m={};d=function(){this.__data__=[],this.size=0};var A,x={},k={};k=function(t,e){return t===e||t!=t&&e!=e},x=function(t,e){for(var r=t.length;r--;)if(k(t[r][0],e))return r;return-1};var P=Array.prototype.splice;A=function(t){var e=this.__data__,r=x(e,t);return!(r<0)&&(r==e.length-1?e.pop():P.call(e,r,1),--this.size,!0)};var S;S=function(t){var e=this.__data__,r=x(e,t);return r<0?void 0:e[r][1]};var E;E=function(t){return x(this.__data__,t)>-1};var z;function I(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}z=function(t,e){var r=this.__data__,n=x(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this},I.prototype.clear=d,I.prototype.delete=A,I.prototype.get=S,I.prototype.has=E,I.prototype.set=z,m=I;var R;R=function(){this.__data__=new m,this.size=0};var B;B=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var F;F=function(t){return this.__data__.get(t)};var M;M=function(t){return this.__data__.has(t)};var T,U,D,H,C={},L={},$={},V={},K={},N="object"==typeof t&&t&&t.Object===Object&&t;H=N;var W="object"==typeof self&&self&&self.Object===Object&&self,q=H||W||Function("return this")();U=(D=q).Symbol;var G={},J=Object.prototype,Q=J.hasOwnProperty,X=J.toString,Y=U?U.toStringTag:void 0;G=function(t){var e=Q.call(t,Y),r=t[Y];try{t[Y]=void 0;var n=!0}catch(t){}var o=X.call(t);return n&&(e?t[Y]=r:delete t[Y]),o};var Z={},tt=Object.prototype.toString;Z=function(t){return tt.call(t)};var et=U?U.toStringTag:void 0;K=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":et&&et in Object(t)?G(t):Z(t)};var rt={};rt=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};V=function(t){if(!rt(t))return!1;var e=K(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e};var nt,ot,at={},ct=D["__core-js_shared__"],it=(ot=/[^.]+$/.exec((nt=ct)&&nt.keys&&nt.keys.IE_PROTO||""))?"Symbol(src)_1."+ot:"";at=function(t){return!!it&&it in t};var ut={},ft=Function.prototype.toString;ut=function(t){if(null!=t){try{return ft.call(t)}catch(t){}try{return t+""}catch(t){}}return""};var st=/^\[object .+?Constructor\]$/,lt=Function.prototype,vt=Object.prototype,pt=lt.toString,yt=vt.hasOwnProperty,ht=RegExp("^"+pt.call(yt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");$=function(t){return!(!rt(t)||at(t))&&(V(t)?ht:st).test(ut(t))};var bt={};bt=function(t,e){return null==t?void 0:t[e]};var dt=(L=function(t,e){var r=bt(t,e);return $(r)?r:void 0})(D,"Map");C=dt;var jt,_t,wt={},gt={},Ot={},mt=L(Object,"create");Ot=mt,_t=function(){this.__data__=Ot?Ot(null):{},this.size=0};var At;At=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e};var xt,kt=Object.prototype.hasOwnProperty;xt=function(t){var e=this.__data__;if(Ot){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return kt.call(e,t)?e[t]:void 0};var Pt,St=Object.prototype.hasOwnProperty;Pt=function(t){var e=this.__data__;return Ot?void 0!==e[t]:St.call(e,t)};var Et;function zt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Et=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Ot&&void 0===e?"__lodash_hash_undefined__":e,this},zt.prototype.clear=_t,zt.prototype.delete=At,zt.prototype.get=xt,zt.prototype.has=Pt,zt.prototype.set=Et,gt=zt,jt=function(){this.size=0,this.__data__={hash:new gt,map:new(C||m),string:new gt}};var It,Rt={},Bt={};Bt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t},Rt=function(t,e){var r=t.__data__;return Bt(e)?r["string"==typeof e?"string":"hash"]:r.map},It=function(t){var e=Rt(this,t).delete(t);return this.size-=e?1:0,e};var Ft;Ft=function(t){return Rt(this,t).get(t)};var Mt;Mt=function(t){return Rt(this,t).has(t)};var Tt;function Ut(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Tt=function(t,e){var r=Rt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},Ut.prototype.clear=jt,Ut.prototype.delete=It,Ut.prototype.get=Ft,Ut.prototype.has=Mt,Ut.prototype.set=Tt,wt=Ut;function Dt(t){var e=this.__data__=new m(t);this.size=e.size}T=function(t,e){var r=this.__data__;if(r instanceof m){var n=r.__data__;if(!C||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new wt(n)}return r.set(t,e),this.size=r.size,this},Dt.prototype.clear=R,Dt.prototype.delete=B,Dt.prototype.get=F,Dt.prototype.has=M,Dt.prototype.set=T,O=Dt;var Ht={};Ht=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t};var Ct={},Lt={},$t={},Vt=function(){try{var t=L(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();$t=Vt,Lt=function(t,e,r){"__proto__"==e&&$t?$t(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r};var Kt=Object.prototype.hasOwnProperty;Ct=function(t,e,r){var n=t[e];Kt.call(t,e)&&k(n,r)&&(void 0!==r||e in t)||Lt(t,e,r)};var Nt={},Wt={};Wt=function(t,e,r,n){var o=!r;r||(r={});for(var a=-1,c=e.length;++a<c;){var i=e[a],u=n?n(r[i],t[i],i,r,t):void 0;void 0===u&&(u=t[i]),o?Lt(r,i,u):Ct(r,i,u)}return r};var qt={},Gt={},Jt={};Jt=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var Qt={},Xt={},Yt={};Yt=function(t){return null!=t&&"object"==typeof t};Xt=function(t){return Yt(t)&&"[object Arguments]"==K(t)};var Zt=Object.prototype,te=Zt.hasOwnProperty,ee=Zt.propertyIsEnumerable,re=Xt(function(){return arguments}())?Xt:function(t){return Yt(t)&&te.call(t,"callee")&&!ee.call(t,"callee")};Qt=re;var ne={},oe=Array.isArray;ne=oe;var ae;ae=function(){return!1};var ce=function(){var t={exports:this},e="object"==typeof this&&this&&!this.nodeType&&this,r=e&&"object"==typeof t&&t&&!t.nodeType&&t,n=r&&r.exports===e?D.Buffer:void 0,o=(n?n.isBuffer:void 0)||ae;return t.exports=o,t.exports}.call({}),ie={},ue=/^(?:0|[1-9]\d*)$/;ie=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&ue.test(t))&&t>-1&&t%1==0&&t<e};var fe,se={},le={};le=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var ve={};ve["[object Float32Array]"]=ve["[object Float64Array]"]=ve["[object Int8Array]"]=ve["[object Int16Array]"]=ve["[object Int32Array]"]=ve["[object Uint8Array]"]=ve["[object Uint8ClampedArray]"]=ve["[object Uint16Array]"]=ve["[object Uint32Array]"]=!0,ve["[object Arguments]"]=ve["[object Array]"]=ve["[object ArrayBuffer]"]=ve["[object Boolean]"]=ve["[object DataView]"]=ve["[object Date]"]=ve["[object Error]"]=ve["[object Function]"]=ve["[object Map]"]=ve["[object Number]"]=ve["[object Object]"]=ve["[object RegExp]"]=ve["[object Set]"]=ve["[object String]"]=ve["[object WeakMap]"]=!1,fe=function(t){return Yt(t)&&le(t.length)&&!!ve[K(t)]};var pe={};pe=function(t){return function(e){return t(e)}};var ye=function(){var t={exports:this},e="object"==typeof this&&this&&!this.nodeType&&this,r=e&&"object"==typeof t&&t&&!t.nodeType&&t,n=r&&r.exports===e&&H.process,o=function(){try{var t=r&&r.require&&r.require("util").types;return t||n&&n.binding&&n.binding("util")}catch(t){}}();return t.exports=o,t.exports}.call({}),he=ye&&ye.isTypedArray,be=he?pe(he):fe;se=be;var de=Object.prototype.hasOwnProperty;Gt=function(t,e){var r=ne(t),n=!r&&Qt(t),o=!r&&!n&&ce(t),a=!r&&!n&&!o&&se(t),c=r||n||o||a,i=c?Jt(t.length,String):[],u=i.length;for(var f in t)!e&&!de.call(t,f)||c&&("length"==f||o&&("offset"==f||"parent"==f)||a&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||ie(f,u))||i.push(f);return i};var je={},_e={},we=Object.prototype;_e=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||we)};var ge={},Oe={};var me=(Oe=function(t,e){return function(r){return t(e(r))}})(Object.keys,Object);ge=me;var Ae=Object.prototype.hasOwnProperty;je=function(t){if(!_e(t))return ge(t);var e=[];for(var r in Object(t))Ae.call(t,r)&&"constructor"!=r&&e.push(r);return e};var xe={};xe=function(t){return null!=t&&le(t.length)&&!V(t)},qt=function(t){return xe(t)?Gt(t):je(t)},Nt=function(t,e){return t&&Wt(e,qt(e),t)};var ke={},Pe={},Se={},Ee={};Ee=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e};var ze=Object.prototype.hasOwnProperty;Se=function(t){if(!rt(t))return Ee(t);var e=_e(t),r=[];for(var n in t)("constructor"!=n||!e&&ze.call(t,n))&&r.push(n);return r},Pe=function(t){return xe(t)?Gt(t,!0):Se(t)},ke=function(t,e){return t&&Wt(e,Pe(e),t)};var Ie=function(){var t={exports:this},e="object"==typeof this&&this&&!this.nodeType&&this,r=e&&"object"==typeof t&&t&&!t.nodeType&&t,n=r&&r.exports===e?D.Buffer:void 0,o=n?n.allocUnsafe:void 0;return t.exports=function(t,e){if(e)return t.slice();var r=t.length,n=o?o(r):new t.constructor(r);return t.copy(n),n},t.exports}.call({}),Re={};Re=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e};var Be={},Fe={},Me={};Me=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,a=[];++r<n;){var c=t[r];e(c,r,t)&&(a[o++]=c)}return a};var Te;Te=function(){return[]};var Ue=Object.prototype.propertyIsEnumerable,De=Object.getOwnPropertySymbols;Fe=De?function(t){return null==t?[]:(t=Object(t),Me(De(t),(function(e){return Ue.call(t,e)})))}:Te,Be=function(t,e){return Wt(t,Fe(t),e)};var He={},Ce={},Le={};Le=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t};var $e={},Ve=Oe(Object.getPrototypeOf,Object);$e=Ve;var Ke=Object.getOwnPropertySymbols;Ce=Ke?function(t){for(var e=[];t;)Le(e,Fe(t)),t=$e(t);return e}:Te,He=function(t,e){return Wt(t,Ce(t),e)};var Ne,We={};We=function(t,e,r){var n=e(t);return ne(t)?n:Le(n,r(t))},Ne=function(t){return We(t,qt,Fe)};var qe;qe=function(t){return We(t,Pe,Ce)};var Ge={},Je={};Je=L(D,"DataView");var Qe={};Qe=L(D,"Promise");var Xe={};Xe=L(D,"Set");var Ye={};Ye=L(D,"WeakMap");var Ze=ut(Je),tr=ut(C),er=ut(Qe),rr=ut(Xe),nr=ut(Ye);Je&&"[object DataView]"!=K(new Je(new ArrayBuffer(1)))||C&&"[object Map]"!=K(new C)||Qe&&"[object Promise]"!=K(Qe.resolve())||Xe&&"[object Set]"!=K(new Xe)||Ye&&K(new Ye),Ge=K;var or={},ar=Object.prototype.hasOwnProperty;or=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&ar.call(t,"index")&&(r.index=t.index,r.input=t.input),r};var cr={},ir={},ur={},fr=D.Uint8Array;ur=fr,ir=function(t){var e=new t.constructor(t.byteLength);return new ur(e).set(new ur(t)),e};var sr={};sr=function(t,e){var r=e?ir(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)};var lr={},vr=/\w*$/;lr=function(t){var e=new t.constructor(t.source,vr.exec(t));return e.lastIndex=t.lastIndex,e};var pr={},yr=U?U.prototype:void 0,hr=yr?yr.valueOf:void 0;pr=function(t){return hr?Object(hr.call(t)):{}};var br={};br=function(t,e){var r=e?ir(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)};cr=function(t,e,r){var n=t.constructor;switch(e){case"[object ArrayBuffer]":return ir(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return sr(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return br(t,r);case"[object Map]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return lr(t);case"[object Set]":return new n;case"[object Symbol]":return pr(t)}};var dr={},jr={},_r=Object.create,wr=function(){function t(){}return function(e){if(!rt(e))return{};if(_r)return _r(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();jr=wr,dr=function(t){return"function"!=typeof t.constructor||_e(t)?{}:jr($e(t))};var gr,Or={};gr=function(t){return Yt(t)&&"[object Map]"==Ge(t)};var mr=ye&&ye.isMap,Ar=mr?pe(mr):gr;Or=Ar;var xr,kr={};xr=function(t){return Yt(t)&&"[object Set]"==Ge(t)};var Pr=ye&&ye.isSet,Sr=Pr?pe(Pr):xr;kr=Sr;var Er={};Er["[object Arguments]"]=Er["[object Array]"]=Er["[object ArrayBuffer]"]=Er["[object DataView]"]=Er["[object Boolean]"]=Er["[object Date]"]=Er["[object Float32Array]"]=Er["[object Float64Array]"]=Er["[object Int8Array]"]=Er["[object Int16Array]"]=Er["[object Int32Array]"]=Er["[object Map]"]=Er["[object Number]"]=Er["[object Object]"]=Er["[object RegExp]"]=Er["[object Set]"]=Er["[object String]"]=Er["[object Symbol]"]=Er["[object Uint8Array]"]=Er["[object Uint8ClampedArray]"]=Er["[object Uint16Array]"]=Er["[object Uint32Array]"]=!0,Er["[object Error]"]=Er["[object Function]"]=Er["[object WeakMap]"]=!1,g=function t(e,r,n,o,a,c){var i,u=1&r,f=2&r,s=4&r;if(n&&(i=a?n(e,o,a,c):n(e)),void 0!==i)return i;if(!rt(e))return e;var l=ne(e);if(l){if(i=or(e),!u)return Re(e,i)}else{var v=Ge(e),p="[object Function]"==v||"[object GeneratorFunction]"==v;if(ce(e))return Ie(e,u);if("[object Object]"==v||"[object Arguments]"==v||p&&!a){if(i=f||p?{}:dr(e),!u)return f?He(e,ke(i,e)):Be(e,Nt(i,e))}else{if(!Er[v])return a?e:{};i=cr(e,v,u)}}c||(c=new O);var y=c.get(e);if(y)return y;c.set(e,i),kr(e)?e.forEach((function(o){i.add(t(o,r,n,o,e,c))})):Or(e)&&e.forEach((function(o,a){i.set(a,t(o,r,n,a,e,c))}));var h=l?void 0:(s?f?qe:Ne:f?Pe:qt)(e);return Ht(h||e,(function(o,a){h&&(o=e[a=o]),Ct(i,a,t(o,r,n,a,e,c))})),i};function zr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ir(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}b=function(t){return g(t,5)};window.onload=function(){return function(){var t=document.getElementById("canvas").getContext("2d");if(t){var e=new Tr(t);setInterval(e.tick,300)}else console.error("could not get CanvasRenderingContext2D")}()};var Br,Fr=function t(){Rr(this,t);var e=[_,w],r=e[Math.floor(Math.random()*e.length)];this.tetromino=new r,this.offset=new a(5,0)},Mr=(Br=b)&&Br.__esModule?Br.default:Br,Tr=function(){function t(e){var r=this;Rr(this,t),Ir(this,"getBaseMatrix",(function(){return new c([[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1]])})),Ir(this,"onKeyDown",(function(t){r.moveByKey(t.key)&&r.draw()})),Ir(this,"tick",(function(){r.move({forward:function(t){return t.offset=t.offset.add(new a(0,1))},backward:function(t){return t.offset=t.offset.add(new a(0,-1))},onCollision:function(){r._currentLayer.cells.filter((function(t){return t.value})).forEach((function(t){return r._backgroundLayer.at(t.vector).value=1})),r.currentHand=new Fr,r.aheadHand=Mr(r.currentHand)}}),r.draw()})),this._ctx=e,this._backgroundLayer=this.getBaseMatrix(),this.currentHand=new Fr,this.aheadHand=Mr(this.currentHand),document.addEventListener("keydown",(function(t){return r.onKeyDown(t)}))}var e,r,n;return e=t,(r=[{key:"moveByKey",value:function(t){switch(t){case"ArrowRight":return this.moveOffset({forward:new a(1,0),backward:new a(-1,0)});case"ArrowLeft":return this.moveOffset({forward:new a(-1,0),backward:new a(1,0)});case"ArrowUp":return this.move({forward:function(t){return t.tetromino.rotate(1)},backward:function(t){return t.tetromino.rotate(-1)}});default:return!1}}},{key:"moveOffset",value:function(t){return this.move({forward:function(e){return e.offset=e.offset.add(t.forward)},backward:function(e){return e.offset=e.offset.add(t.backward)}})}},{key:"move",value:function(t){var e=t.forward,r=t.backward,n=t.onCollision,o=void 0===n?function(){}:n;return e(this.aheadHand),this.collisionDetected()?(r(this.aheadHand),o(),!1):(e(this.currentHand),!0)}},{key:"collisionDetected",value:function(){var t=this;return this.aheadHand.tetromino.posture.cells.filter((function(t){return t.value})).some((function(e){return t._backgroundLayer.at(t.aheadHand.offset.add(e.vector)).value}))}},{key:"draw",value:function(){var t=this;this._backgroundLayer.cells.forEach((function(e){var r=t._currentLayer.at(e.vector),n=e.vector.add(new a(-2,-3));t._ctx.fillStyle=e.value||r.value?"rgba(0, 0, 0)":"rgba(224, 224, 224)",t._ctx.fillRect(40*n.x+7,40*n.y+7,26,26)}))}},{key:"_currentLayer",get:function(){var t=this,e=this.getBaseMatrix();return this.currentHand.tetromino.posture.cells.filter((function(t){return t.value})).forEach((function(r){return e.at(r.vector.add(t.currentHand.offset)).value=1})),e}}])&&zr(e.prototype,r),n&&zr(e,n),t}()}();
//# sourceMappingURL=ts.c52f6bc7.js.map
