!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var n=function n(r){var o=this;t(this,n),e(this,"initialElem",(function(){var t=document.createElement("li");return t.style.listStyle="none",t.style.width="78%",t.style.height="78%",t.style.border="2px solid",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",t})),e(this,"fill",(function(){o.elem.style.borderColor="#000000",o.inner.fill()})),e(this,"clear",(function(){o.elem.style.borderColor="#E0E0E0",o.inner.clear()})),this.elem=this.initialElem(),this.inner=new i(this.elem),r.appendChild(this.elem)},i=function n(i){var r=this;t(this,n),e(this,"fill",(function(){r.elem.style.backgroundColor="#000000"})),e(this,"clear",(function(){r.elem.style.backgroundColor="#E0E0E0"})),this.elem=document.createElement("div"),i.appendChild(this.elem),this.elem.style.width="75%",this.elem.style.height="75%",this.elem.style.backgroundColor="#E0E0E0"};function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var o=function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r(this,"down",(function(){return new t(i.x,i.y-1)})),r(this,"up",(function(){return new t(i.x,i.y+1)})),r(this,"right",(function(){return new t(i.x+1,i.y)})),r(this,"left",(function(){return new t(i.x-1,i.y)})),r(this,"equals",(function(t){return i.x===t.x&&i.y===t.y})),this.x=e,this.y=n};function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=[{patterns:[[[0,0,0,0],[0,0,1,0],[0,1,1,1],[0,0,0,0]],[[0,0,0,0],[0,0,1,0],[0,0,1,1],[0,0,1,0]],[[0,0,0,0],[0,0,0,0],[0,1,1,1],[0,0,1,0]],[[0,0,0,0],[0,0,1,0],[0,1,1,0],[0,0,1,0]]]},{patterns:[[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]]},{patterns:[[[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0]]]},{patterns:[[[0,0,0,0],[1,1,0,0],[0,1,1,0],[0,0,0,0]],[[0,0,0,0],[0,0,1,0],[0,1,1,0],[0,1,0,0]]]},{patterns:[[[0,0,0,0],[0,0,1,1],[0,1,1,0],[0,0,0,0]],[[0,0,0,0],[0,1,0,0],[0,1,1,0],[0,0,1,0]]]},{patterns:[[[0,0,0,0],[0,0,1,0],[1,1,1,0],[0,0,0,0]],[[1,0,0,0],[1,0,0,0],[1,1,0,0],[0,0,0,0]],[[0,0,0,0],[1,1,1,0],[1,0,0,0],[0,0,0,0]],[[0,0,0,0],[0,1,1,0],[0,0,1,0],[0,0,1,0]]]},{patterns:[[[0,0,0,0],[0,1,0,0],[0,1,1,1],[0,0,0,0]],[[0,0,0,0],[0,1,1,0],[0,1,0,0],[0,1,0,0]],[[0,0,0,0],[0,1,1,1],[0,0,0,1],[0,0,0,0]],[[0,0,0,1],[0,0,0,1],[0,0,1,1],[0,0,0,0]]]}],c=function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,"patternIndex",0),a(this,"currentPattern",(function(){return n.shape.patterns[n.patternIndex]})),a(this,"occupiedPositions",(function(){var t=[];return n.currentPattern().forEach((function(e,i){return e.forEach((function(e,r){1==e&&t.push(new o(n.position.x+r,n.position.y+(3-i)))}))})),t})),a(this,"moveDown",(function(){return n.move((function(){return n.position=n.position.down()}),(function(){return n.position=n.position.up()}))})),a(this,"moveRight",(function(){return n.move((function(){return n.position=n.position.right()}),(function(){return n.position=n.position.left()}))})),a(this,"moveLeft",(function(){return n.move((function(){return n.position=n.position.left()}),(function(){return n.position=n.position.right()}))})),a(this,"rotateClockwise",(function(){return n.move(n.incrementPatternIndex,n.decrementPatternIndex)})),a(this,"rotateCounterClockwise",(function(){return n.move(n.decrementPatternIndex,n.incrementPatternIndex)})),a(this,"incrementPatternIndex",(function(){n.patternIndex=(n.patternIndex+1)%n.shape.patterns.length})),a(this,"decrementPatternIndex",(function(){n.patternIndex=(n.patternIndex+n.shape.patterns.length-1)%n.shape.patterns.length})),a(this,"move",(function(t,e){return t(),!!n.canBeIn(n.occupiedPositions())||(e(),!1)})),a(this,"canBeIn",(function(t){return t.every(n.grid.occupiable)})),this.shape=s[Math.floor(Math.random()*s.length)],this.position=new o((e.area.width-this.shape.patterns[0].length)/2,e.area.height-this.shape.patterns[0].length/2),this.grid=e};var u=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.height=e,this.width=n};function l(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m=function t(e){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,"area",new u(20,10)),f(this,"currentTetrimino",new c(this)),f(this,"sediment",[]),f(this,"initialElem",(function(t){var e=document.createElement("ul");return e.style.display="grid",e.style.gridTemplateColumns="repeat(".concat(t.width,", 32px)"),e.style.gridTemplateRows="repeat(".concat(t.height,", 32px)"),e.style.justifyItems="center",e.style.alignItems="center",e})),f(this,"initialCells",(function(t){return Array(t.height).fill(null).map((function(){return Array(t.width).fill(null).map((function(){return new n(i.elem)}))}))})),f(this,"draw",(function(){i.cells.forEach((function(t){return t.forEach((function(t){return t.clear()}))})),i.currentTetrimino.occupiedPositions().concat(i.sediment).forEach((function(t){i.within(t)&&i.cells[i.area.height-1-t.y][t.x].fill()}))})),f(this,"tick",(function(){var t;i.currentTetrimino.moveDown()||((t=i.sediment).push.apply(t,l(i.currentTetrimino.occupiedPositions())),i.currentTetrimino=new c(i));i.draw()})),f(this,"occupiable",(function(t){return i.within(t)&&i.sediment.every((function(e){return!e.equals(t)}))})),f(this,"within",(function(t){return 0<=t.x&&t.x<=i.area.width-1&&0<=t.y&&t.y<=i.area.height-1})),f(this,"moveTetriminoLeft",(function(){i.currentTetrimino.moveLeft()})),f(this,"moveTetriminoRight",(function(){i.currentTetrimino.moveRight()})),f(this,"rotateTetriminoClockwise",(function(){i.currentTetrimino.rotateClockwise()})),f(this,"rotateTetriminoCounterClockwise",(function(){i.currentTetrimino.rotateCounterClockwise()})),this.elem=this.initialElem(this.area),this.cells=this.initialCells(this.area),e.appendChild(this.elem),this.draw()};function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,"elem",document.createElement("div")),p(this,"grid",new m(this.elem)),p(this,"toggleTimer",(function(){n.timerId?(clearInterval(n.timerId),n.timerId=null):n.setTimer()})),p(this,"setTimer",(function(){n.timerId=setInterval((function(){n.grid.tick()}),100)})),p(this,"onKeyDown",(function(t){switch(t.key){case"ArrowLeft":n.grid.moveTetriminoLeft();break;case"ArrowRight":n.grid.moveTetriminoRight();break;case"d":n.grid.rotateTetriminoClockwise();break;case"s":n.grid.rotateTetriminoCounterClockwise();break;case"p":n.toggleTimer()}})),e.appendChild(this.elem),this.setTimer(),document.addEventListener("keydown",(function(t){return n.onKeyDown(t)}))};function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),y(this,"elem",document.getElementById("app")),y(this,"prepareGame",(function(){e.game=null,document.addEventListener("keypress",(function(){e.game||(e.game=new d(e.elem))}))})),this.prepareGame()};window.onload=function(){return new w}}();
//# sourceMappingURL=ts.76ab29d1.js.map
